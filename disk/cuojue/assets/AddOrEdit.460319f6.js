import{u as y,br as I,a as d,b4 as c,f as e,a2 as C,be as k,a$ as i,aZ as o,I as g,bf as F,C as v,aj as _,ak as q,B as D,bc as p,n as L,a5 as U,bp as E}from"./index.f2f1cf32.js";import{F as T}from"./FolderTree.acd442e1.js";import{u as m}from"./useT.d8472b1f.js";import"./index.4dd3b46e.js";import"./api.b4db5517.js";const B=r=>{const l=m();return e(i,{display:"inline-flex",flexDirection:"row",alignItems:"center",gap:"$2",rounded:"$md",shadow:"$md",p:"$2",w:"fit-content",get children(){return[e(o,{mb:"0",get children(){return l(`users.permissions.${r.name}`)}}),e(E,{get checked(){return r.can},onChange:()=>r.onChange(!r.can)})]}})},H=()=>{const r=m(),{params:l,back:h}=y(),{id:a}=l,[s,t]=I({id:0,username:"",password:"",base_path:"",role:0,permission:0}),[f,b]=d(()=>c.get(`/admin/user/get?id=${a}`));a&&(async()=>{const n=await b();p(n,t)})();const[w,$]=d(()=>c.post(`/admin/user/${a?"update":"create"}`,s));return e(U,{get loading(){return f()},get children(){return e(C,{w:"$full",alignItems:"start",spacing:"$2",get children(){return[e(k,{get children(){return r(`global.${a?"edit":"add"}`)}}),e(i,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[e(o,{for:"username",display:"flex",alignItems:"center",get children(){return r("users.username")}}),e(g,{id:"username",get value(){return s.username},onInput:n=>t("username",n.currentTarget.value)})]}}),e(i,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[e(o,{for:"password",display:"flex",alignItems:"center",get children(){return r("users.password")}}),e(g,{id:"password",type:"password",placeholder:"********",get value(){return s.password},onInput:n=>t("password",n.currentTarget.value)})]}}),e(i,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[e(o,{for:"base_path",display:"flex",alignItems:"center",get children(){return r("users.base_path")}}),e(T,{id:"base_path",get value(){return s.base_path},onChange:n=>t("base_path",n),onlyFolder:!0})]}}),e(i,{w:"$full",required:!0,get children(){return[e(o,{display:"flex",alignItems:"center",get children(){return r("users.permission")}}),e(F,{w:"$full",wrap:"wrap",gap:"$2",get children(){return e(v,{each:_,children:(n,u)=>e(B,{name:n,get can(){return q.can(s,u())},onChange:x=>{x?t("permission",s.permission|=1<<u()):t("permission",s.permission&=~(1<<u()))}})})}})]}}),e(D,{get loading(){return w()},onClick:async()=>{const n=await $();p(n,()=>{L.success(r("global.save_success")),h()})},get children(){return r(`global.${a?"save":"add"}`)}})]}})}})};export{H as default};
