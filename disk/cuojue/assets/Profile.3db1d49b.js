import{u as I,q as i,ao as t,a as v,b5 as C,f as e,x as u,an as l,b_ as S,b$ as T,c0 as k,c1 as F,a7 as a,bc as g,bf as x,c2 as B,b0 as d,a_ as m,I as h,F as U,B as p,bd as y,c3 as A,n as P,C as R,am as H,a2 as L,bu as M}from"./index.6ff39b49.js";import{u as D}from"./useT.c01ad73b.js";import{b as q}from"./useTitle.fdff9b4a.js";import{L as G}from"./LinkWithBase.bf9c6ba6.js";const V=r=>e(M,{get colorScheme(){return r.can?"success":"danger"},get children(){return r.children}}),J=()=>{const r=D();q("manage.sidemenu.profile");const{to:o}=I(),[s,f]=i(t().username),[c,w]=i(""),[b,_]=v(()=>C.post("/me/update",{username:s(),password:c()}));return e(L,{w:"$full",spacing:"$4",alignItems:"start",get children(){return[e(u,{get when(){return!l.is_guest(t())},get fallback(){return[e(S,{status:"warning",flexDirection:{"@initial":"column","@lg":"row"},get children(){return[e(T,{mr:"$2_5"}),e(k,{mr:"$2_5",get children(){return r("users.guest-tips")}}),e(F,{get children(){return r("users.modify_nothing")}})]}}),e(a,{spacing:"$2",get children(){return[e(g,{get children(){return r("global.have_account")}}),e(g,{color:"$info9",as:G,get href(){return`/@login?redirect=${encodeURIComponent(location.pathname)}`},get children(){return r("global.go_login")}})]}})]},get children(){return[e(x,{get children(){return r("users.update_profile")}}),e(B,{gap:"$2",columns:{"@initial":1,"@md":2},get children(){return[e(d,{get children(){return[e(m,{for:"username",get children(){return r("users.change_username")}}),e(h,{id:"username",get value(){return s()},onInput:n=>{f(n.currentTarget.value)}})]}}),e(d,{get children(){return[e(m,{for:"password",get children(){return r("users.change_password")}}),e(h,{id:"password",type:"password",placeholder:"********",get value(){return c()},onInput:n=>{w(n.currentTarget.value)}}),e(U,{get children(){return r("users.change_password-tips")}})]}})]}}),e(a,{spacing:"$2",get children(){return[e(p,{get loading(){return b()},onClick:async()=>{const n=await _();y(n,()=>{A({...t(),username:s()}),P.success(r("users.update_profile_success")),o(`/@login?redirect=${encodeURIComponent(location.pathname)}`)})},get children(){return r("global.save")}}),e(u,{get when(){return!t().otp},get children(){return e(p,{colorScheme:"accent",onClick:()=>{o("/@manage/2fa")},get children(){return r("users.enable_2fa")}})}})]}})]}}),e(a,{wrap:"wrap",gap:"$2",mt:"$2",get children(){return e(R,{each:H,children:(n,$)=>e(V,{get can(){return l.can(t(),$())},get children(){return r(`users.permissions.${n}`)}})})}})]}})};export{J as default};
